<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
  <title>Swiper demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1" />
  <!-- Link Swiper's CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css" />
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" />
  <!-- Font Awesome CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
 <!-- Demo styles -->
<style>
  html,
  body {
    position: relative;
    height: 100%;
    background: #eee;
    font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
    font-size: 14px;
    color: #000;
    margin: 0;
    padding: 0;
  }
    .fa-solid,
  fa-users {
    color: #ea9999 !important;
  }
  .text-info {
    color: #ea9999 !important;
  }
  .btn-info {
    color: white;
    background-color: #ea9999;
    border-color: #ff9494;
  }
  .btn-info:hover {
    background-color: #fb6161;
    border-color: #ff9494;
  }
  .btn-info:active {
    background-color: #fb6161 !important;
    border-color: #ff9494 !important;
  }
  .Guestselection {
    color: white;
    background-color: #ea9999;
    border-color: #ff9494;
    width: 100px;
    margin: auto;
    font-size: 16px;
  }
  .Guestselection:hover {
    background-color: #fb6161;
    border-color: #ff9494;
  }
  .Guestselection:active {
    background-color: #fb6161 !important;
    border-color: #ff9494 !important;
  }
    .card-block {
    padding: 20px;
  }
  .card-title {
    text-align: center;
  }
  /* Style for the form container */
    .read-only-field {
    background-color: #f0f0f0 !important; /* Add the desired background color and !important */
    cursor: not-allowed;
  }
  #form-container {
    margin: 20px;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 5px;
    background-color: #f9f9f9;
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    max-width: 800px;
    margin: 0 auto;
  }
  #form-container > * {
    flex-basis: 100%;
  }
  #form-container input,
  #form-container select,
  #form-container textarea {
    width: 100%;
    padding: 5px;
    margin-bottom: 10px;
    border: 1px solid #ccc;
    border-radius: 3px;
    background-color: #fff;
  }
  /* Style for the labels */
  #form-container label {
    display: block;
    margin-bottom: 10px;
    font-weight: bold;
  }
  /* Style for the "Book!" button */
  #form-container button {
    margin-top: 10px;
    padding: 8px 16px;
    border: none;
    border-radius: 3px;
    background-color: #ea9999;
    color: #fff;
    font-size: 14px;
    cursor: pointer;
  }
  #form-container button:last-child {
    margin-top: 0;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .accept-container {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
    margin-right: 70px;
  }
  .accept-container label {
    margin-right: 5px;
  }

  .required-label::after {
    content: "*";
    color: red;
  }
  .required-label::after {
  content: '*';
  color: red;
  margin-left: 4px;
}


  .separator {
    border: none;
    border-top: 1px solid #ccc;
    margin: 20px 0;
  }
    .error-container {
    margin-top: -10px;
    margin-bottom: 10px;
    padding: 0px;
    color: #ff0000;
  }

.error-message {
  color: red;
  font-size: 14px;
  margin: 0;
}
  
  @keyframes ldio-5pc9ti1scmm {
  0% { opacity: 1 }
  100% { opacity: 0 }
}
.ldio-5pc9ti1scmm div {
  left: 94px;
  top: 48px;
  position: absolute;
  animation: ldio-5pc9ti1scmm linear 1s infinite;
  background: #fe718d;
  width: 12px;
  height: 24px;
  border-radius: 6px / 12px;
  transform-origin: 6px 52px;
}.ldio-5pc9ti1scmm div:nth-child(1) {
  transform: rotate(0deg);
  animation-delay: -0.9166666666666666s;
  background: #fe718d;
}.ldio-5pc9ti1scmm div:nth-child(2) {
  transform: rotate(30deg);
  animation-delay: -0.8333333333333334s;
  background: #fe718d;
}.ldio-5pc9ti1scmm div:nth-child(3) {
  transform: rotate(60deg);
  animation-delay: -0.75s;
  background: #fe718d;
}.ldio-5pc9ti1scmm div:nth-child(4) {
  transform: rotate(90deg);
  animation-delay: -0.6666666666666666s;
  background: #fe718d;
}.ldio-5pc9ti1scmm div:nth-child(5) {
  transform: rotate(120deg);
  animation-delay: -0.5833333333333334s;
  background: #fe718d;
}.ldio-5pc9ti1scmm div:nth-child(6) {
  transform: rotate(150deg);
  animation-delay: -0.5s;
  background: #fe718d;
}.ldio-5pc9ti1scmm div:nth-child(7) {
  transform: rotate(180deg);
  animation-delay: -0.4166666666666667s;
  background: #fe718d;
}.ldio-5pc9ti1scmm div:nth-child(8) {
  transform: rotate(210deg);
  animation-delay: -0.3333333333333333s;
  background: #fe718d;
}.ldio-5pc9ti1scmm div:nth-child(9) {
  transform: rotate(240deg);
  animation-delay: -0.25s;
  background: #fe718d;
}.ldio-5pc9ti1scmm div:nth-child(10) {
  transform: rotate(270deg);
  animation-delay: -0.16666666666666666s;
  background: #fe718d;
}.ldio-5pc9ti1scmm div:nth-child(11) {
  transform: rotate(300deg);
  animation-delay: -0.08333333333333333s;
  background: #fe718d;
}.ldio-5pc9ti1scmm div:nth-child(12) {
  transform: rotate(330deg);
  animation-delay: 0s;
  background: #fe718d;
}
.loadingio-spinner-spinner-7646pt8rie {
  width: 300px;
  height: 300px;
  display: inline-block;
  overflow: hidden;
  background: rgba(NaN, NaN, NaN, 0);
}
.ldio-5pc9ti1scmm {
  width: 100%;
  height: 100%;
  position: relative;
  transform: translateZ(0) scale(1);
  backface-visibility: hidden;
  transform-origin: 0 0; /* see note above */
}
.ldio-5pc9ti1scmm div { box-sizing: content-box; }
#loading {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 9999;
}

#loading p {
  margin-top: 10px;
  color: #333;
  font-size: 14px;
  opacity: 0; /* Set initial opacity to 0 */
  animation: fadeAnimation 2s infinite; /* Apply the animation */
}

@keyframes fadeAnimation {
  0% {
    opacity: 0; /* Start with fade out */
  }
  50% {
    opacity: 1; /* Fade in */
  }
  100% {
    opacity: 0; /* Fade out */
  }
}
  
      .fa-arrow-left:before {
        content: "<" !important;
    }
    .fa-arrow-right:before {
        content: ">" !important;
    }
    .flaticon2-left-arrow:before {
        content: "<";
    }
    .flaticon2-right-arrow:before {
        content: ">";
    }
  
  .swiper {
  max-width: 550px;
  max-height: 300px;
  width: 100%;
  height: 100%;
}

.swiper-slide {
  text-align: center;
  font-size: 18px;
  background: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
}

.swiper-slide img {
  display: block;
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}
  
  .loading-icon {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
    width: 16px; /* Adjust width as needed */
  height: 16px; /* Adjust height as needed */
}
</style>
</head>
<body>
  
  <!-- Swiper -->
  <div class="swiper mySwiper">
  <div class="swiper-wrapper">
    <div class="swiper-slide"><img class="img-fluid swiper-lazy" src="https://cf.bstatic.com/xdata/images/hotel/max1024x768/444640354.jpg?k=45cf87dfc093933924e4def8f0f7a9f1e11d5ef9c75803ef23d242a87a62655f&o=" alt="salon"></div>
    <div class="swiper-slide"><img class="img-fluid swiper-lazy" src="https://cf.bstatic.com/xdata/images/hotel/max1024x768/444643706.jpg?k=702f7265392ee76414b6029ac8d04caac30109dc25c441ae438854e79789072f&o=" alt="kitchen"></div>
    <div class="swiper-slide"><img class="img-fluid swiper-lazy" src="https://cf.bstatic.com/xdata/images/hotel/max1024x768/444642261.jpg?k=a347328da01d536d5e344362fb93828ac35a7b3f7b4210d62a456160fbdce5d4&o=" alt="small room"></div>
    <div class="swiper-slide"><img class="img-fluid swiper-lazy" src="https://cf.bstatic.com/xdata/images/hotel/max1024x768/444641536.jpg?k=037d6826d1ebcb5b40db0dc123be85b13e6f3026276712e8194f793b729fd095&o=" alt="big room"></div>
    <div class="swiper-slide"><img class="img-fluid swiper-lazy" src="https://cf.bstatic.com/xdata/images/hotel/max1024x768/443362031.jpg?k=a2cf57d76ff2b5a5a429e3176a173797eab121b7239c4455b691964d93cf4790&o=" alt="bathroom"></div>
  </div>
  <div class="swiper-button-next"></div>
  <div class="swiper-button-prev"></div>
  <div class="swiper-pagination"></div>
</div>

<!-- Swiper JS -->
<script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>

<!-- Initialize Swiper -->
<script>
  var swiper = new Swiper(".mySwiper", {
    slidesPerView: "auto",
    spaceBetween: 10,
    pagination: {
      el: ".swiper-pagination",
      type: "progressbar",
    },
    navigation: {
      nextEl: ".swiper-button-next",
      prevEl: ".swiper-button-prev",
    },
  });
</script>

    <!-- Your card div content here -->
<div class="card-block">
<h4 class="card-title text-info">House 1</h4>
<ul class="list-inline text-sm mb-4" align="center">
<li class="list-inline-item me-3"><i class="fa-solid fa-users"></i> 6 Guests</li>
<li class="list-inline-item me-3"><i class="fa-solid fa-shower"></i> 1 Bathroom</li>
<li class="list-inline-item me-3"><i class="fa-solid fa-bed"></i> 4 Beds</li>
<li class="list-inline-item me-3"><i class="fa-solid fa-square-parking"></i> 1 Park.</li>
<li class="list-inline-item me-3"><i class="fa-solid fa-snowflake"></i> AC</li>
<li class="list-inline-item me-3"><i class="fa-solid fa-wifi"></i> WiFi</li>
</ul>
<p align="center"><a href="https://teteje.github.io/moreinfodomek1.html" class="btn btn-info">More information</a></p>
</div>
    <!-- Form container -->
    <div id="form-container">
      


      <!-- Form fields will be added here dynamically -->
    </div>
    

  <!-- Swiper JS -->
  <script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
  <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<div id="loading" class="loadingio-spinner-spinner-7646pt8rie"><p>This may take up to 15 seconds...</p><div class="ldio-5pc9ti1scmm">
<div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div>
</div></div>
<script>
  $(document).ready(function() {
// Pricing logic
var specialDayPrices = {
  '2024-12-25': 450, // Christmas: December 25, 2024
  '2024-12-26': 450, // Date in between special days: December 26, 2024
  '2024-12-27': 450, // Christmas: December 27, 2024
  '2024-05-01': 450, // May 1st and May 3rd 2024
  '2024-05-02': 450, // May 1st and May 3rd 2024
  '2024-05-03': 450, // May 1st and May 3rd 2024
  '2024-05-04': 450, // May 1st and May 3rd 2024
};

var normalDayPriceUntil2023 = 360;
var normalDayPriceFrom2024 = 375;

var additionalPrice = 0;

function calculateTotalPrice(startDate, endDate, numberOfGuests) {
  // Assuming startDate and endDate are in the format 'YYYY-MM-DD'
  var start = dayjs(startDate);
  var end = dayjs(endDate);

  // Calculate the number of nights
  var numberOfNights = end.diff(start, 'day'); // not Include the end date

  var totalPrice = 0;

  // Iterate through each night and calculate the price
  for (var i = 0; i < numberOfNights; i++) {
    var currentDate = start.add(i, 'day').format('YYYY-MM-DD');
    var isSpecialDay = specialDayPrices[currentDate] !== undefined;

    // Adjust special day price based on the number of guests
    if (isSpecialDay && numberOfGuests <= 4) {
      totalPrice += 420; // Special day price for 1 to 4 guests
    } else if (isSpecialDay) {
      totalPrice += specialDayPrices[currentDate]; // Use the original special day price
    } else if (start.year() <= 2023) {
      // Pricing until the end of 2023
      totalPrice += normalDayPriceUntil2023;
    } else {
      // Pricing from 2024 onward
      totalPrice += normalDayPriceFrom2024;
    }
  }

  // Additional pricing based on the number of guests
  if (numberOfGuests === 3) {
    additionalPrice = 20;
  } else if (numberOfGuests === 4) {
    additionalPrice = 35;
  } else if (numberOfGuests >= 5) {
    additionalPrice = 70;
  }

  // Add additional pricing to the total
  totalPrice += additionalPrice;

  return totalPrice;
}



    
    var checkin;
    var checkout;
    var numberOfGuestsSelect;
    var nameInput;
    var addressInput;
    var emailInput;
    var phoneInput;
    var commentsInput;
    var acceptInput;

    function updateForm() {
      var formContainer = $('#form-container');
      // Clear existing form fields
      formContainer.empty();
      var fromLabel = $('<label>').text('Check-in:');
      var fromInput = $('<input>').attr('type', 'text').attr('name', 'from').addClass('read-only-field').attr('readonly', true);
      formContainer.append(fromLabel).append(fromInput);

      var toLabel = $('<label>').text('Check-out:');
      var toInput = $('<input>').attr('type', 'text').attr('name', 'to').addClass('read-only-field').attr('readonly', true);
      formContainer.append(toLabel).append(toInput);

      var priceLabel = $('<label>').text('Price: ');
      // Assign the priceInput element to the global variable
        priceInput = $('<input>').attr('type', 'text').attr('name', 'price').addClass('read-only-field').prop('disabled', true);
        formContainer.append(priceLabel).append(priceInput);


      var numberOfGuestsLabel = $('<label>').text('Number of Guests:').addClass('required-label');
      numberOfGuestsSelect = $('<select>').attr('name', 'numberOfGuests').prop('required', true);
      numberOfGuestsSelect.append('<option value="1">1 Guest</option>');
      numberOfGuestsSelect.append('<option value="2">2 Guests</option>');
      numberOfGuestsSelect.append('<option value="3">3 Guests</option>');
      numberOfGuestsSelect.append('<option value="4">4 Guests</option>');
      numberOfGuestsSelect.append('<option value="5">5 Guests</option>');
      numberOfGuestsSelect.append('<option value="6">6 Guests</option>');
      formContainer.append(numberOfGuestsLabel).append(numberOfGuestsSelect);

      var nameLabel = $('<label>').text('Name and Surname:').addClass('required-label');
      nameInput = $('<input>').attr('type', 'text').attr('name', 'name').prop('required', true);
      formContainer.append(nameLabel).append(nameInput);

      var addressLabel = $('<label>').text('Address:').addClass('required-label');
      addressInput = $('<input>').attr('type', 'text').attr('name', 'address').prop('required', true);
      formContainer.append(addressLabel).append(addressInput);

      var emailLabel = $('<label>').text('Email:').addClass('required-label');
      emailInput = $('<input>').attr('type', 'email').attr('name', 'email').prop('required', true);
      formContainer.append(emailLabel).append(emailInput);

      var phoneLabel = $('<label>').text('Phone number:').addClass('required-label');
      phoneInput = $('<input>').attr('type', 'tel').attr('name', 'phone').prop('required', true);
      formContainer.append(phoneLabel).append(phoneInput);

      var commentsLabel = $('<label>').text('Comments: ');
      commentsInput = $('<textarea>').attr('name', 'comments');
      formContainer.append(commentsLabel).append(commentsInput);

      var acceptContainer = $('<div>').addClass('accept-container');
      var acceptLabel = $('<label>').text('I accept the Terms & Conditions:').addClass('required-label');
      acceptInput = $('<input>').attr('type', 'checkbox').attr('name', 'accept');
      var termsLink = $('<a>').attr('href', 'https://www.napanskiejgorze.com/regulamin').attr('target', '_blank').text('Terms & Condtions (PL only)');

      acceptContainer.append(acceptLabel).append(acceptInput).append(termsLink);
      formContainer.append(acceptContainer);
      // Add a separator
      var separator = $('<hr>').addClass('separator');
      formContainer.append(separator);
      
      // Create the submit button
var submitButton = $('<button>')
  .attr('type', 'submit')
  .attr('id', 'submitBtn')
  .addClass('submit-button') // Add this class for styling
  .text('Book Now!')
  .append('<img src="https://media.tenor.com/On7kvXhzml4AAAAj/loading-gif.gif" class="loading-icon" alt="Loading..." />');

formContainer.append(submitButton);


      // Get the URL parameters
      const urlParams = new URLSearchParams(window.location.search);
      checkin = urlParams.get('checkin');
      checkout = urlParams.get('checkout');

      // Set the values of the fromInput and toInput fields
      fromInput.val(checkin);
      toInput.val(checkout);

      // Calculate and set the initial price
      var numberOfGuests = parseInt(numberOfGuestsSelect.val());
      var startDate = moment(checkin);
      var endDate = moment(checkout);
      var totalPrice = calculateTotalPrice(startDate, endDate, numberOfGuests);
      priceInput.val(totalPrice);

      // Update the price when the number of guests or check-in date changes
      numberOfGuestsSelect.on('change', function() {
        var numberOfGuests = parseInt($(this).val());
        var startDate = moment(checkin);
        var endDate = moment(checkout);

        // Reset additionalPrice
        additionalPrice = 0;

        // Update additionalPrice based on the number of guests
        if (numberOfGuests === 3) {
          additionalPrice = 20;
        } else if (numberOfGuests === 4) {
          additionalPrice = 35;
        } else if (numberOfGuests >= 5) {
          additionalPrice = 70;
        }

        var totalPrice = calculateTotalPrice(startDate, endDate, numberOfGuests);
        priceInput.val(totalPrice);
      });

      fromInput.on('change', function() {
        var numberOfGuests = parseInt(numberOfGuestsSelect.val());
        var startDate = moment($(this).val());
        var endDate = moment(checkout);
        var totalPrice = calculateTotalPrice(startDate, endDate, numberOfGuests);
        priceInput.val(totalPrice);
      });

      toInput.on('change', function() {
        var numberOfGuests = parseInt(numberOfGuestsSelect.val());
        var startDate = moment(checkin);
        var endDate = moment($(this).val());
        var totalPrice = calculateTotalPrice(startDate, endDate, numberOfGuests);
        priceInput.val(totalPrice);
      });
    }

    // Call the updateForm function to generate the form
    updateForm();

    var submitButton = $('#submitBtn');

    submitButton.on('click', function(e) {
      e.preventDefault(); // Prevent the default form submission behavior

      // Hide any existing error messages
      $('.error-container').remove();

      // Perform form validation
      var isValid = true;

    // Check if all mandatory fields are filled
var mandatoryFields = [
  { name: 'numberOfGuests', message: 'Number of Guests' },
  { name: 'name', message: 'Name & Surname' },
  { name: 'address', message: 'Address' },
  { name: 'email', message: 'Email' },
  { name: 'phone', message: 'Phone number' },
  { name: 'accept', message: 'Accept Terms & Conditions' }
];

for (var i = 0; i < mandatoryFields.length; i++) {
  var field = mandatoryFields[i].name;
  var fieldValue = $('[name="' + field + '"]').val();
  if (!fieldValue) {
    isValid = false;
    showErrorMessage(field, 'Please fill in ' + mandatoryFields[i].message + '.');
  }
}


      // Validate the phone number format
var phoneNumber = $('[name="phone"]').val();
var phoneRegex = /^\+?\d+$/; // Updated regular expression
if (!phoneRegex.test(phoneNumber)) {
  isValid = false;
  showErrorMessage('phone', 'Please provide a valid phone number.');
}


      // Validate the email format
      var email = $('[name="email"]').val();
      var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        isValid = false;
        showErrorMessage('email', 'Please provide a valid email.');
      }

        // Check if the "Accept terms and conditions" checkbox is checked
  var acceptChecked = $('[name="accept"]').prop('checked');
  if (!acceptChecked) {
    isValid = false;
    showErrorMessage('accept', 'Please accept the terms and conditions.');
  }

      if (isValid) {
        // Show the loading GIF
        $('#loading').show();
                 submitButton.find('.button-text').hide();
    submitButton.find('.loading-icon').show();

        // Get form data
        var formData = {
      checkin: checkin,
      checkout: checkout,
      numberOfGuests: numberOfGuestsSelect.val(),
      price: priceInput.val(),
      name: nameInput.val(),
      address: addressInput.val(),
      email: emailInput.val(),
      phone: phoneInput.val(),
      comments: commentsInput.val(),
      accept: "Accepted"
    };

    // Submit the form data via AJAX
    $.ajax({
      url: 'https://script.google.com/macros/s/AKfycbxgqg2iYq7j44VZetdwfEpM5Vc8wXLmhH-ITUp_6HX1ZEpp2hhtUn96_aDwSekpThon/exec',
      type: 'POST',
      data: formData,
      success: function(response) {
        // Hide loading GIF
        $('#loading').hide();
             submitButton.find('.loading-icon').hide();
        submitButton.find('.button-text').hide();

        // Redirect to congratulatory page
        redirectToCongratulationsPage();
      },
      error: function() {
        // Hide loading GIF
        $('#loading').hide();
             submitButton.find('.loading-icon').hide();
        submitButton.find('.button-text').hide();

        // Redirect to congratulatory page
        redirectToCongratulationsPage();
      }
    });
  }
}); // <-- Add this closing parenthesis

function redirectToCongratulationsPage() {
  // Redirect to the congratulatory page
  window.location.href = 'https://teteje.github.io/congrats.html';
}

function showErrorMessage(field, message) {
  // Remove any existing error messages for the field
  $('#' + field + '-error').remove();

  // Create the error message element
  var errorContainer = $('<div>').addClass('error-container').attr('id', field + '-error');
  var errorMessage = $('<p>').addClass('error-message').text(message);

  // Append the error message after the input field
  var fieldInput = $('[name="' + field + '"]');
  fieldInput.after(errorContainer.append(errorMessage));

  // Adjust the position of the error message
  var fieldBottom = fieldInput.position().top + fieldInput.outerHeight();
  errorContainer.css('top', fieldBottom + 'px');
}



  });
</script>


</body>
</html>
