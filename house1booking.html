<script>
  $(document).ready(function () {
    // Pricing logic
    var specialDayPrices = {
      '12-25': 400,  // Christmas: December 25
      '12-26': 400,  // Christmas: December 26
      '12-27': 400,  // Christmas: December 27
    };

    var normalDayPrice = 360;
    var additionalPrice = 0;

    function calculateTotalPrice(startDate, endDate, numberOfGuests) {
      var oneNightPrice = normalDayPrice;
      var startDateFormatted = startDate.format('MM-DD');

      if (startDateFormatted in specialDayPrices) {
        oneNightPrice = specialDayPrices[startDateFormatted];
      }

      if (numberOfGuests === 3) {
        additionalPrice = 20;
      } else if (numberOfGuests === 4) {
        additionalPrice = 35;
      } else if (numberOfGuests >= 5) {
        additionalPrice = 70;
      }

      var numberOfNights = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24));
      var totalPrice = (oneNightPrice * numberOfNights) + (additionalPrice * numberOfNights);
      return totalPrice;
    }

    function updateForm() {
      var formContainer = $('#form-container');
      // Clear existing form fields
      formContainer.empty();
      var fromLabel = $('<label>').text('Check-in:');
      var fromInput = $('<input>').attr('type', 'text').attr('name', 'from').prop('readonly', true);
      formContainer.append(fromLabel).append(fromInput);
      var toLabel = $('<label>').text('Check-out:');
      var toInput = $('<input>').attr('type', 'text').attr('name', 'to').prop('readonly', true);
      formContainer.append(toLabel).append(toInput);
      var priceLabel = $('<label>').text('Cena: ');
      var priceInput = $('<input>').attr('type', 'text').attr('name', 'price').prop('readonly', true).addClass('read-only-field');
      formContainer.append(priceLabel).append(priceInput);
      var numberOfGuestsLabel = $('<label>').text('Number of Guests:');
      var numberOfGuestsSelect = $('<select>').attr('name', 'numberOfGuests').prop('required', true);
      numberOfGuestsSelect.append('<option value="1">1 person</option>');
      numberOfGuestsSelect.append('<option value="2">2 people</option>');
      numberOfGuestsSelect.append('<option value="3">3 people</option>');
      numberOfGuestsSelect.append('<option value="4">4 people</option>');
      numberOfGuestsSelect.append('<option value="5">5 people</option>');
      numberOfGuestsSelect.append('<option value="6">6 people</option>');
      formContainer.append(numberOfGuestsLabel).append(numberOfGuestsSelect);
      var nameLabel = $('<label>').text('Name:');
      var nameInput = $('<input>').attr('type', 'text').attr('name', 'name').prop('required', true);
      formContainer.append(nameLabel).append(nameInput);
      var addressLabel = $('<label>').text('Address:');
      var addressInput = $('<input>').attr('type', 'text').attr('name', 'address').prop('required', true);
      formContainer.append(addressLabel).append(addressInput);
      var emailLabel = $('<label>').text('Email:');
      var emailInput = $('<input>').attr('type', 'email').attr('name', 'email').prop('required', true);
      formContainer.append(emailLabel).append(emailInput);
      var phoneLabel = $('<label>').text('Phone Number:');
      var phoneInput = $('<input>').attr('type', 'tel').attr('name', 'phone').prop('required', true);
      formContainer.append(phoneLabel).append(phoneInput);
      var commentsLabel = $('<label>').text('Comments:');
      var commentsInput = $('<textarea>').attr('name', 'comments');
      formContainer.append(commentsLabel).append(commentsInput);
      var acceptContainer = $('<div>').addClass('accept-container');
      var acceptLabel = $('<label>').text('I have read and accept the terms and conditions:');
      var acceptInput = $('<input>').attr('type', 'checkbox').attr('name', 'accept');
      var termsLink = $('<a>').attr('href', 'https://www.example.com/terms').attr('target', '_blank').text('Terms and Conditions');
      acceptContainer.append(acceptLabel).append(acceptInput).append(termsLink);
      formContainer.append(acceptContainer);
      // Add a separator
      var separator = $('<hr>').addClass('separator');
      formContainer.append(separator);
      // Create the submit button
      var submitButton = $('<button>').attr('type', 'submit').text('Submit');
      formContainer.append(submitButton);

      // Get the URL parameters
      const urlParams = new URLSearchParams(window.location.search);
      const checkin = urlParams.get('checkin');
      const checkout = urlParams.get('checkout');

      // Set the values of the fromInput and toInput fields
      fromInput.val(checkin);
      toInput.val(checkout);

      // Update the price when number of guests or check-in date changes
      numberOfGuestsSelect.on('change', function () {
        var numberOfGuests = parseInt($(this).val());
        var startDate = moment(checkin);
        var endDate = moment(checkout);
        var totalPrice = calculateTotalPrice(startDate, endDate, numberOfGuests);
        priceInput.val(totalPrice);
      });

      fromInput.on('change', function () {
        var numberOfGuests = parseInt(numberOfGuestsSelect.val());
        var startDate = moment($(this).val());
        var endDate = moment(checkout);
        var totalPrice = calculateTotalPrice(startDate, endDate, numberOfGuests);
        priceInput.val(totalPrice);
      });

      toInput.on('change', function () {
        var numberOfGuests = parseInt(numberOfGuestsSelect.val());
        var startDate = moment(checkin);
        var endDate = moment($(this).val());
        var totalPrice = calculateTotalPrice(startDate, endDate, numberOfGuests);
        priceInput.val(totalPrice);
      });
    }

    // Call the updateForm function to generate the form
    updateForm();
  });
</script>
